function addValidCliente(){$("#txtNroDocCliente").rules("add",{required:!0}),$("#txtEmailCliente").rules("add",{required:!0,email:!0})}function addValidCliente_Natural(){$("#txtApePaternoCliente").rules("add",{required:!0}),$("#txtApeMaternoCliente").rules("add",{required:!0}),$("#txtNombresCliente").rules("add",{required:!0})}function addValidCliente_Juridica(){$("#txtRazonSocialCliente").rules("add",{required:!0})}function habilitarModuloCliente(e,t){var a="",i="";"cliente"==e?(a="#txtSearchCliente",i="#ddlTipoDocCliente,#txtRazonSocialCliente,#txtNroDocCliente,#txtDireccionCliente,#txtTelefonoCliente,#txtEmailCliente"):(a="#txtSearchCliente__Servicio",i="#ddlTipoDocCliente__Servicio,#txtRazonSocialCliente__Servicio,#txtNroDocCliente__Servicio,#txtDireccionCliente__Servicio,#txtTelefonoCliente__Servicio,#txtEmailCliente__Servicio"),"GET"==t?(habilitarControl(a,!0),habilitarClienteNatural(!1),habilitarControl(i,!1)):(idcliente_selected=0,$("#txtSearchCliente__Servicio").val(""),habilitarControl(a,!1),habilitarClienteNatural(!0),habilitarControl(i,!0))}function ListarAperturas(){$.ajax({type:"GET",url:"services/ventas/aperturacaja-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"3",fecha:GetToday()},success:function(e){var t=0,a=e.length,i="";if(a>0)for(;t<a;)i+="<tr>",i+="<td>"+(t+1)+"</td>",i+="<td>"+e[t].tm_apellidopaterno+" "+e[t].tm_apellidomaterno+" "+e[t].tm_nombres+"</td>",i+="<td>"+e[t].NombreMoneda+"</td>",i+="<td>"+e[t].tm_monto_inicial+"</td>",i+="<td>"+e[t].tm_monto_final+"</td>",i+="<td>"+e[t].Turno+"</td>",i+="<td>"+e[t].Estado+"</td>",i+="</tr>",++t;$("#tableAperturaDia tbody").html(i)},error:function(e){console.log(e)}})}function RegistrarAperturaCaja(){var e=new FormData,t=$("#pnlAperturaCaja :input").serializeArray();e.append("btnRegistrarApertura","btnRegistrarApertura"),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),$.ajax({type:"POST",url:"services/ventas/caja-post.php",cache:!1,contentType:!1,processData:!1,dataType:"json",data:e,success:function(e){createSnackbar(e.titulomsje),"0"!=e.rpta&&(closeCustomModal("#pnlAperturaCaja"),AperturaByDefault())},error:function(e){console.log(e)}})}function RegistrarMovCaja(){var e=new FormData,t=$("#pnlRegMovimientoCaja :input").serializeArray();e.append("btnRegistrarMovCaja","btnRegistrarMovCaja"),e.append("hdIdAperturaCaja",$("#hdIdAperturaCaja").val()),e.append("hdIdPersona",$("#hdIdPersona").val()),e.append("hdIdMoneda",$("#hdIdMoneda").val()),e.append("hdTipoDataPersona",$("#hdTipoDataPersona").val()),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),$.ajax({type:"POST",url:"services/ventas/caja-post.php",cache:!1,contentType:!1,processData:!1,dataType:"json",data:e,success:function(e){createSnackbar(e.titulomsje),"0"!=e.rpta&&($("#pnlCajaActual .btn-group button.btn-primary").removeClass("btn-primary"),$('#pnlCajaActual .btn-group button[data-tipomov="'+$("#ddlTipoMovimiento").val()+'"]').addClass("btn-primary"),closeCustomModal("#pnlRegMovimientoCaja"),AperturaByDefault())}})}function CerrarCaja(){var e=new FormData,t=$("#pnlCierreCaja :input").serializeArray();e.append("btnCerrarCaja","btnCerrarCaja"),e.append("hdIdAperturaCaja",$("#hdIdAperturaCaja").val()),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),$.ajax({url:"services/ventas/caja-post.php",type:"POST",cache:!1,contentType:!1,processData:!1,dataType:"json",data:e,success:function(e){createSnackbar(e.titulomsje),"0"!=e.rpta&&(closeCustomModal("#pnlCierreCaja"),$("#pnlCajaActual .btn-group button").removeClass("btn-primary").first().trigger("click"),AperturaByDefault(),habilitarCaja(!1))},error:function(e){console.log(e)}})}function habilitarOptionCliente(e){habilitarControl('input:radio[name="rbRegCliente"]',e)}function habilitarClienteNatural(e){habilitarControl(".rowClienteNatural input:text",e)}function habilitarClienteJuridico(e){habilitarControl(".rowClienteJuridico input:text",e)}function LimpiarCobranza(){$("#ddlNombreTarjeta")[0].selectedIndex=0,$("#txtNumeroTarjeta").val(""),$("#txtImporteTarjeta").val(""),$("#hdIdCliente").val("0"),$("#ddlTipoDocCliente")[0].selectedIndex=0,$("#txtNroDocCliente").val(""),$("#txtApePaternoCliente").val(""),$("#txtApeMaternoCliente").val(""),$("#txtNombresCliente").val(""),$("#txtRazonSocialCliente").val(""),$("#txtDireccionCliente").val(""),$("#txtTelefonoCliente").val(""),$("#txtEmailCliente").val(""),habilitarControl("#btnCobrar",!0)}function MostrarPanelCobranza(){if(LimpiarCobranza(),0==Number($("#lblTotalPago .monto").text())){var e=$("#lblTotalCobro .monto").text();$("#lblTotalPago .monto").text(e),$("#lblEfectivoPago").text(e)}openModalCallBack("#pnlCobranza",function(){habilitarOptionCliente(!$("#chkClienteDefault")[0].checked)})}function MostrarTipoDocCliente(e,t){$.ajax({url:"services/documentos/documentos-tributables.php",type:"GET",dataType:"json",data:{codigotributable:t},success:function(t){var a="",i=0,o=t.length;if(o>0)for(;i<o;)a+='<option value="'+t[i].tm_iddocident+'">'+t[i].tm_descripcion+"</option>",++i;else a='<option value="0">No hay tipos de documento para este tipo de cliente.</option>';$(e).html(a)},error:function(e){console.log(e)}})}function GestionarCobranza(){$.ajax({url:"services/tipocomprobante/tipocomprobante-search.php",type:"GET",dataType:"json",data:{tipo:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:""},success:function(e){var t=0,a=e.length,i="";if(a>0){for(;t<a;){var o=0==t?" checked":"";i+='<p><input class="with-gap" name="rbTipoComprobante" data-impuesto="'+e[t].tm_porcjimpuesto+'" type="radio" id="rbTipoComprobante'+e[t].tm_idtipocomprobante+'" value="'+e[t].tm_idtipocomprobante+'"'+o+' /><label for="rbTipoComprobante'+e[t].tm_idtipocomprobante+'">'+e[t].tm_nombre+"</label></p>",++t}i+="<h5>Medio de pago</h5>",i+='<p><input class="with-gap" name="rbMedioPago" type="radio" id="rbMedioPago1" value="1" checked /><label for="rbMedioPago1">MEDIOS DE PAGO</label></p>',i+='<p><input class="with-gap" name="rbMedioPago" type="radio" id="rbMedioPago2" value="2" /><label for="rbMedioPago2">CR&Eacute;DITO PERSONAL</label></p>',i='<div class="scrollbarra">'+i+"</div>",MessageBox({title:"Seleccione tipo de comprobante",content:i,width:"320px",height:"390px",buttons:[{primary:!0,content:"Continuar",onClickButton:function(e){var t=$('input[name="rbTipoComprobante"]:checked').val(),a=$('input[name="rbTipoComprobante"]:checked').attr("data-impuesto");$("#hdTipoComprobante").val(t);var i=$('input[name="rbMedioPago"]:checked').val();$("#hdMedioPago").val(i),"2"==i?($("#chkClienteDefault").prop("checked",!1),$("#rbObtenerCliente").prop("checked",!0),habilitarControl("#txtSearchCliente",!0),habilitarClienteNatural(!1),habilitarClienteJuridico(!1),habilitarControl("#ddlTipoDocCliente, #txtNroDocCliente, #txtDireccionCliente, #txtTelefonoCliente, #txtEmailCliente",!1),addValidCliente(),$("#tabcob_2 span").trigger("click"),$("#tabcob_1").addClass("hide")):($("#rbObtenerCliente").prop("checked",!0),habilitarControl("#txtSearchCliente",!1),habilitarClienteNatural(!1),habilitarClienteJuridico(!1),habilitarControl("#ddlTipoDocCliente,#txtNroDocCliente,#txtDireccionCliente,#txtTelefonoCliente,#txtEmailCliente",!1),$("#chkClienteDefault").prop("checked",!0),$("#tabcob_1 span").trigger("click"),$("#tabcob_1").removeClass("hide")),"2"==t?($("#hdTipoCliente").val("JU"),$(".rowClienteNatural").addClass("hide"),$(".rowClienteJuridico").removeClass("hide"),calcultarTotalFinal(a),MostrarTipoDocCliente("#ddlTipoDocCliente","6"),$('label[for="txtNroDocCliente"]').text("Código de contribuyente"),"2"==i&&addValidCliente_Juridica()):($("#hdTipoCliente").val("NA"),$(".rowClienteNatural").removeClass("hide"),$(".rowClienteJuridico").addClass("hide"),calcultarTotalFinal(a),MostrarTipoDocCliente("#ddlTipoDocCliente","1"),$('label[for="txtNroDocCliente"]').text("Número de documento"),"2"==i&&addValidCliente_Natural()),MostrarPanelCobranza()}}],cancelButton:!0})}},error:function(e){console.log(e)}}),$("#lblEfectivoPago .monto").text($("#lblTotalPago .monto").text()),$("#lblEfectivoCambio .monto").text($("#lblTotalCambio .monto").text())}function GuardarCobranza(){var e=new FormData,t=$("#pnlCaja :input").serializeArray(),a=$("#pnlCobranza :input").serializeArray();e.append("btnCobrar","btnCobrar"),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),Array.prototype.forEach.call(a,function(t){e.append(t.name,t.value)}),e.append("hdIdOrden",$("#hdIdOrden").val()),e.append("hdIdAperturaCaja",$("#hdIdAperturaCaja").val()),e.append("hdTotalSinImpuesto",$("#lblTotalSinImpuesto .monto").text()),e.append("hdImpuesto",$("#lblImpuesto .monto").text()),e.append("hdTotalConImpuesto",$("#lblTotalConImpuesto .monto").text()),$.ajax({url:"services/ventas/caja-post.php",type:"POST",dataType:"json",data:e,cache:!1,contentType:!1,processData:!1,success:function(e){if(createSnackbar(e.titulomsje),"0"!=e.rpta){$("#titleOrden").text("Orden #:"),$("#gvArticuloMenu tbody").html(""),$("#lblTotalCobro .monto").text("0.00"),$("#lblTotalCambio .monto").text("0.00"),$("#lblTotalPago .monto").text("0.00");var t=e.datosVenta;habilitarControl("#btnCobrar",!1),habilitarControl("#btnImprimir",!0);var a=_.groupBy(t,function(e){return e.CodigoVenta+"#"+e.Cliente+"#"+e.SimboloMoneda+"#"+e.TipoComprobante}),i=_.map(a,function(e){return{CodigoVenta:e[0].CodigoVenta,Cliente:e[0].Cliente,SimboloMoneda:e[0].SimboloMoneda,TipoComprobante:e[0].TipoComprobante,tm_base_imponible:e[0].tm_base_imponible,tm_impuesto:e[0].tm_impuesto,tm_total:e[0].tm_total,list_articulos:e}}),o=i.length,n="";if(o>0){var r=i[0].SimboloMoneda;$("#lblTipoComprobante_print").text(i[0].TipoComprobante),$("#lblCodigoVenta_print").text(i[0].CodigoVenta),$("#lblFechaHora_print").text(moment().format("DD/MM/YYYY hh:mm:ss")),$("#lblNombreCliente_print").text(i[0].Cliente),$("#lblTotal_print").text(r+Number(i[0].tm_base_imponible).toFixed(2)),$("#lblImpuestos_print").text(r+Number(i[0].tm_impuesto).toFixed(2)),$("#lblTotalImp_print").text(r+Number(i[0].tm_total).toFixed(2));var l=i[0].list_articulos,c=0;c=1==l.length?0==l[0].nombreArticulo.trim().length?0:1:l.length;var s=0;if(c>0)for(;s<c;)n+="<tr>",n+="<td>"+l[s].nombreArticulo+"</td>",n+="<td>"+l[s].td_cantidad+"</td>",n+="<td>"+r+Number(l[s].td_precio).toFixed(2)+"</td>",n+="<td>"+r+Number(l[s].td_subtotal).toFixed(2)+"</td>",n+="</tr>",++s}$(".performance-facts__table tbody").html(n),$("#hdIdOrden").val("0"),clearValidationsRules("#pnlCobranza")}},error:function(e){console.log(e)}})}function calcularCambio(e){var t=0,a=0,i=Number($("#lblTotalCobro .monto").text());isNaN(e)||(e.length>0&&(t=Number(e)),t>0&&(a=t-i)),$("#lblTotalPago .monto").text(t.toFixed(2)),$("#lblTotalCambio .monto").text(a.toFixed(2))}function ListarPersonalPorTurno(e){var t="#gvPersonalTurno .collection";$.ajax({type:"GET",url:"services/organigrama/organigrama-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"3",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),turno:e},success:function(e){var a=0,i=e.length,o="";if(i>0){for(;a<i;){var n=e[a].tm_idpersonal,r=e[a].tm_foto;o+='<li class="collection-item avatar no-border dato" data-idmodel="'+n+'">',o+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+n+'" />',o+='<i class="icon-select material-icons circle white-text">done</i><div class="layer-select"></div>',o+="no-set"==r?'<i class="material-icons circle">&#xE853;</i>':'<img src="'+r+'" alt="" class="circle">',o+='<span class="title descripcion">'+e[a].tm_apellidopaterno+" "+e[a].tm_apellidomaterno+" "+e[a].tm_nombres+"</span>",o+='<p><span class="docidentidad">RUC: '+e[a].tm_nrodni+"</span> -  "+e[a].tm_email+"</p>",o+='<div class="divider"></div>',o+="</li>",++a}$(t).html(o)}else $(t).html("<h2>No se encontraron resultados.</h2>")},error:function(e){console.log(e)}})}function createItem__Articulo(e,t,a,i,o,n,r,l,c,s){var d="";return d+='<tr data-iditem="'+i+'" class="dato">',d+='<td class="hide">',d+='<input name="mc_articulo['+filaArticulo+'][iddetalle]" type="hidden" id="iddetalle'+filaArticulo+'" value="'+i+'" /><input name="mc_articulo['+filaArticulo+'][tipomenudia]" type="hidden" id="tipomenudia'+filaArticulo+'" value="'+a+'" /><input name="mc_articulo['+filaArticulo+'][idproducto]" type="hidden" id="idproducto'+filaArticulo+'" value="'+e+'" /><input name="mc_articulo['+filaArticulo+'][idcliente]" type="hidden" id="idcliente'+filaArticulo+'" value="'+t+'" /></td>',d+='<td data-title="Articulo" class="v-align-middle nombre-articulo">'+o,"04"==a&&(d+=" (Fecha de inicio: "+ConvertMySQLDate(s)+") Cliente: "+n),d+='<input type="hidden" name="mc_articulo['+filaArticulo+'][fechainicio]" id="fechainicio'+filaArticulo+'" value="'+s+'">',d+="</td>",d+='<td data-title="Cantidad" class="text-right">',d+='<input type="hidden" name="mc_articulo['+filaArticulo+'][cantidad]" id="cantidad'+filaArticulo+'" value="'+r+'">'+r,d+="</td>",d+='<td data-title="Precio" class="text-right">',d+='<input type="hidden" name="mc_articulo['+filaArticulo+'][precio]" id="precio'+filaArticulo+'" value="'+l+'">'+l,d+="</td>",d+='<td data-title="Subtotal" class="text-right">',d+='<input type="hidden" name="mc_articulo['+filaArticulo+'][subtotal]" id="subtotal'+filaArticulo+'" value="'+c.toFixed(2)+'" class="subtotal">'+c.toFixed(2),d+="</td>",d+='<td><a class="padding5 mdl-button mdl-button--icon tooltipped center-block" href="#" data-action="delete" data-placement="left" data-toggle="tooltip" title="Eliminar"><i class="material-icons">&#xE872;</i></a></td>',d+="</tr>",++filaArticulo,d}function buildMenu(e){var t=e.length,a=0,i="";if(t>0&&e[0].nombreProducto.length>0)for(var o=0;o<t;){var n=e[o].td_cantidad,r=Number(e[o].td_precio).toFixed(2),l=Number(e[o].td_subtotal);i+=createItem__Articulo(e[o].tm_idproducto,e[o].tm_idcliente,e[o].ta_tipomenudia,e[o].td_idatencion_articulo,e[o].nombreProducto,e[o].nombreCliente,n,r,l,e[o].td_fechainicio),a+=l,++o}$("#gvArticuloMenu tbody").html(i),$("#lblTotalCobro .monto").text(a.toFixed(2)),$(".tooltipped").tooltip({delay:50})}function recalcularTotal(){var e=$("#gvArticuloMenu tbody tr"),t=e.length,a=0,i=0;if(t>0)for(;i<t;){var o=Number(e[i].getElementsByClassName("subtotal")[0].value);a+=o,++i}$("#lblTotalCobro .monto").text(a.toFixed(2))}function calcultarTotalFinal(e){var t=Number($("#lblTotalCobro .monto").text()),a=t/(1+Number(e)/100),i=a*(Number(e)/100);$("#lblTotalSinImpuesto .monto").text(a.toFixed(2)),$("#lblImpuesto .monto").text(i.toFixed(2)),$("#lblTotalConImpuesto .monto").text(t.toFixed(2))}function getOrden(e){$.ajax({url:"services/atencion/atencion-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"ONE-ATENCION",idatencion:e},success:function(e){var t=_.groupBy(e,function(e){return e.tm_idatencion+"#"+e.tm_nroatencion+"#"+e.tm_fechahora}),a=_.map(t,function(e){return{tm_idatencion:e[0].tm_idatencion,tm_nroatencion:e[0].tm_nroatencion,tm_fechahora:e[0].tm_fechahora,list_articulos:e}}),i=a.length;i>0&&($("#hdIdOrden").val(a[0].tm_idatencion),$("#titleOrden").text("Orden #: "+a[0].tm_nroatencion),buildMenu(a[0].list_articulos))},error:function(e){console.log(e)}})}function LimpiarCaja(){$("#hdIdAperturaCaja").val("0"),$("#hdIdMoneda").val("0"),$("#lblFechaRegistroCaja").text(""),$("#lblTurnoCaja").text(""),$("#lblMonedaInicial").text(""),$("#lblImporteInicial").text("0.00"),$("#lblMonedaActual").text(""),$("#lblImporteActual").text("0.00"),$("#lblMonedaTotalCaja").text(""),$("#lblImporteTotalCaja").text("0.00"),$("#tableRegistroCaja .ibody tbody").html("")}function ListarMovimientoCaja(e){var t=$("#pnlCajaActual .btn-group button.btn-primary").attr("data-tipomov");precargaExp("#tableRegistroCaja",!0),$.ajax({type:"GET",url:"services/ventas/detalleapertura-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",idregistrocaja:e,tipomov:t},success:function(e){var t=0,a=e.length,i="";if(a>0)for(;t<a;)i+="<tr>",i+="<td>"+(t+1)+"</td>",i+="<td>"+e[t].Concepto+"</td>",i+="<td>"+e[t].FechaReg.split(" ")[1]+"</td>",i+="<td>"+e[t].Moneda+"</td>",i+="<td>"+e[t].tm_monto_mn+"</td>",i+="<td>"+e[t].tm_observacion+"</td>",i+="</tr>",++t;$("#tableRegistroCaja tbody").html(i),precargaExp("#tableRegistroCaja",!1)},error:function(e){console.log(e)}})}function habilitarCaja(e){e?($('#mnuOpcionesMenu a[data-action="caja-open"], #modalCajaBlocker').addClass("hide"),$('#mnuOpcionesMenu a[data-action="caja-close"]').removeClass("hide")):($('#mnuOpcionesMenu a[data-action="caja-open"], #modalCajaBlocker').removeClass("hide"),$('#mnuOpcionesMenu a[data-action="caja-close"]').addClass("hide"))}function ComprobarApertura(){$.ajax({url:"services/ventas/aperturacaja-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"2",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),fecha:GetToday()},success:function(e){var t=e.length,a=t>0;habilitarCaja(a),AperturaByDefault()},error:function(e){console.log(e)}})}function AperturaByDefault(){$.ajax({type:"GET",url:"services/ventas/aperturacaja-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val()},success:function(e,t,a){var i=e.length;LimpiarCaja(),i>0&&($("#hdIdAperturaCaja").val(e[0].tm_idregistro_caja),$("#hdIdMoneda").val(e[0].tm_idmoneda),$("#lblFechaRegistroCaja").text(ConvertMySQLDate(e[0].tm_fecharegistro)),$("#lblTurnoCaja").text(e[0].Turno),$("#lblMonedaIngreso").text(e[0].SimboloMoneda),$("#lblImporteIngreso").text(Number(e[0].tm_monto_ingreso).toFixed(2)),$("#lblMonedaSalida").text(e[0].SimboloMoneda),$("#lblImporteSalida").text(Number(e[0].tm_monto_salida).toFixed(2)),$("#lblMonedaInicial").text(e[0].SimboloMoneda),$("#lblImporteInicial").text(Number(e[0].tm_monto_inicial).toFixed(2)),$("#lblMonedaActual").text(e[0].SimboloMoneda),$("#lblImporteActual").text(Number(e[0].tm_monto_actual).toFixed(2)),ListarMovimientoCaja(e[0].tm_idregistro_caja),habilitarCaja(!0))},error:function(e){console.log(e)}})}function ListarInsumos(e){$.ajax({type:"GET",url:"services/productos/productos-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:$("#txtSearchProd").val(),pagina:e},success:function(t){var a=t.length,i=0,o="",n="#gvInsumo tbody",a=t.length;if(a>0){for(;i<a;){var r=t[i].tm_idproducto,l=t[i].tm_foto.replace("_o","_s42");o+='<tr data-idmodel="'+r+'">',o+="<td>",o+='<input type="checkbox" class="filled-in" id="chkInsumo'+i+'" value="'+r+'" name="itemsventa['+i+'][idproducto]" /><label for="chkInsumo'+i+'"></label>',o+="</td>",o+="<td>",o+="no-set"==l?'<i class="material-icons circle">&#xE853;</i>':'<img src="'+l+'" alt="" class="circle" style="width: 42px; height: 42px;">',o+="</td>",o+='<td data-title="Articulo" class="descripcion">',o+=t[i].tm_nombre+"</td>",o+='<td data-title="Cantidad">',o+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input disabled class="mdl-textfield__input align-right margin-bottom10 cantidad" type="number" step="any" id="cantidad'+i+'" name="itemsventa['+i+'][cantidad]" value=""><label class="mdl-textfield__label" for="cantidad'+i+'"></label></div>',o+="</td>",o+='<td data-title="Precio">',o+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input disabled class="mdl-textfield__input align-right margin-bottom10 precio" type="number" step="any" id="precio'+i+'" name="itemsventa['+i+'][precio]" value="'+t[i].tm_precioVenta+'"><label class="mdl-textfield__label" for="precio'+i+'"></label></div>',o+="</td>",o+='<td data-title="SubTotal" class="subtotal">',o+='<input type="hidden" id="subtotal'+i+'" name="itemsventa['+i+'][subtotal]" value="0"><h4 class="grey-text text-right">0.00</h4>',o+="</td>",o+="</td>",++i}gvInsumo.currentPage(gvInsumo.currentPage()+1),"1"==e?$(n).html(o):$(n).append(o)}else"1"==e&&$(n).html("<h2>No se encontraron resultados.</h2>"),habilitarControl("#btnAddItemsVenta",!1)},error:function(e){console.log(e)}})}function ListarServicios(e){$.ajax({url:"services/servicio/servicio-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:$("#txtSearchServ").val(),pagina:e},success:function(t){var a=0,i="",o="#gvServicio tbody",n=t.length;if(n>0){for(;a<n;)i+='<tr data-idservicio="'+t[a].tm_idservicio+'">',i+="<td>",i+='<input type="checkbox" class="filled-in" id="chkServicio'+a+'" value="'+t[a].tm_idservicio+'" name="itemsservicio['+a+'][idproducto]" /><label for="chkServicio'+a+'"></label>',i+="</td>",i+='<td data-title="Servicio" class="descripcion">'+t[a].tm_nombre,i+='<input type="hidden" id="serv_descripcion'+a+'" name="itemsservicio['+a+'][descripcion]" value="'+t[a].tm_nombre+'">',i+='<input type="hidden" class="serv_IdCliente__Servicio" id="serv_IdCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_IdCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_TipoDocCliente__Servicio" id="serv_TipoDocCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_TipoDocCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_NroDocCliente__Servicio" id="serv_NroDocCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_NroDocCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_ApePaternoCliente__Servicio" id="serv_ApePaternoCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_ApePaternoCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_ApeMaternoCliente__Servicio" id="serv_ApeMaternoCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_ApeMaternoCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_NombresCliente__Servicio" id="serv_NombresCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_NombresCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_RazonSocialCliente__Servicio" id="serv_RazonSocialCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_RazonSocialCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_DireccionCliente__Servicio" id="serv_DireccionCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_DireccionCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_TelefonoCliente__Servicio" id="serv_TelefonoCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_TelefonoCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_EmailCliente__Servicio" id="serv_EmailCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_EmailCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_PaisCliente__Servicio" id="serv_PaisCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_PaisCliente__Servicio]" value="" />',i+='<input type="hidden" class="serv_RegionCliente__Servicio" id="serv_RegionCliente__Servicio'+a+'" name="itemsservicio['+a+'][serv_RegionCliente__Servicio]" value="" />',i+="</td>",i+='<td data-title="Cliente" class="descripcion"><strong>Sin cliente</strong><br /><button class="btn btn-primary" type="button" data-action="select-cliente">Seleccionar cliente</button></td>',i+='<td data-title="Fecha de inicio">',i+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input class="mdl-textfield__input align-right fechainicio" type="text" id="serv_fechainicio'+a+'" name="itemsservicio['+a+'][fechainicio]" value="'+moment(new Date).format("DD/MM/YYYY")+'"><label class="mdl-textfield__label" for="serv_fechainicio'+a+'"></label></div>',i+="</td>",i+='<td data-title="Precio">',i+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input disabled class="mdl-textfield__input align-right precio" type="number" step="any" id="serv_precio'+a+'" name="itemsservicio['+a+'][precio]" value="'+Number(t[a].tm_precio).toFixed(2)+'"><label class="mdl-textfield__label" for="serv_precio'+a+'"></label></div>',i+='<input type="hidden" id="serv_subtotal'+a+'" name="itemsservicio['+a+'][subtotal]" value="'+Number(t[a].tm_precio).toFixed(2)+'">',i+="</td>",i+="</tr>",++a;gvServicio.currentPage(gvServicio.currentPage()+1),"1"==e?$(o).html(i):$(o).append(i),$(".fechainicio").datetimepicker({locale:"es",format:"DD/MM/YYYY"})}else"1"==e&&$(o).html(""),habilitarControl("#btnAddItemsVenta",!1)},error:function(e){console.log(e)}})}function LimpiarPreSeleccion_articulo(){$("#gvInsumo input:checkbox").prop("checked",!1),$("#gvInsumo .precio").val(""),$("#gvInsumo .cantidad").val(""),$("#gvInsumo .subtotal input:hidden").val(""),$("#gvInsumo .subtotal h4").text("0.00").addClass("grey-text"),habilitarControl("#btnAddItemsVenta",!1)}function LimpiarPreSeleccion_servicio(){var e=$("#gvServicio tbody tr"),t=e.length;if(t>0)for(var a=0;a<t;){var i=e[a];i.getElementsByClassName("serv_TipoDocCliente__Servicio")[0].value="",i.getElementsByClassName("serv_NroDocCliente__Servicio")[0].value="",i.getElementsByClassName("serv_ApePaternoCliente__Servicio")[0].value="",i.getElementsByClassName("serv_ApeMaternoCliente__Servicio")[0].value="",i.getElementsByClassName("serv_NombresCliente__Servicio")[0].value="",i.getElementsByClassName("serv_RazonSocialCliente__Servicio")[0].value="",i.getElementsByClassName("serv_DireccionCliente__Servicio")[0].value="",i.getElementsByClassName("serv_TelefonoCliente__Servicio")[0].value="",i.getElementsByClassName("serv_EmailCliente__Servicio")[0].value="",i.getElementsByClassName("serv_PaisCliente__Servicio")[0].value="",i.getElementsByClassName("serv_RegionCliente__Servicio")[0].value="",++a}$("#gvServicio input:checkbox").prop("checked",!1),$("#gvServicio .subtotal h4").text("0.00").addClass("grey-text"),habilitarControl("#btnAddItemsVenta",!1)}function AgregarItemsVenta(){var e=new FormData,t=$("#gvInsumo :input").serializeArray();e.append("btnAddItemsVenta","btnAddItemsVenta"),e.append("hdIdOrden",$("#hdIdOrden").val()),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),$.ajax({url:"services/ventas/caja-post.php",type:"POST",dataType:"json",data:e,cache:!1,contentType:!1,processData:!1,success:function(e){createSnackbar(e.titulomsje),"0"!=e.rpta&&(getOrden(e.rpta),LimpiarPreSeleccion_articulo())},error:function(e){console.log(e)}})}function AgregarServicio(){var e=new FormData,t=$("#gvServicio :input").serializeArray();e.append("btnAddServicioVenta","btnAddServicioVenta"),e.append("hdIdOrden",$("#hdIdOrden").val()),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),$.ajax({url:"services/ventas/caja-post.php",type:"POST",dataType:"json",data:e,cache:!1,contentType:!1,processData:!1,success:function(e){createSnackbar(e.titulomsje),"0"!=e.rpta&&(getOrden(e.rpta),LimpiarPreSeleccion_servicio())},error:function(e){console.log(e)}})}function eliminarArticulo(e){var t=getParentsUntil(e,"#gvArticuloMenu",".dato"),a=t[0].getAttribute("data-iditem");MessageBox({content:"¿Desea quitar este item?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Quitar item",onClickButton:function(e){var i=new FormData;i.append("btnRemoveArticles","btnRemoveArticles"),i.append("hdIdArticuloOrden",a),$.ajax({url:"services/atencion/atencion-post.php",type:"POST",dataType:"json",data:i,cache:!1,contentType:!1,processData:!1,success:function(e){"0"!=e.rpta&&($(t[0]).remove(),recalcularTotal())},error:function(e){console.log(e)}})}}],cancelButton:!0})}function clearValidationsRules(e){"#pnlCobranza"==e&&($("#txtNroDocCliente").rules("remove"),$("#txtEmailCliente").rules("remove"),"2"==$("#hdTipoComprobante").val()?$("#txtRazonSocialCliente").rules("remove"):($("#txtApePaternoCliente").rules("remove"),$("#txtApeMaternoCliente").rules("remove"),$("#txtNombresCliente").rules("remove")))}function ListSalesByDate(e){ListSales("services/ventas/ventas-fecha-search.php",{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:$("#txtSearchVenta").val(),fecha:e})}function ListSales(e,t){precargaExp("#pnlListado",!0),$.ajax({url:e,type:"GET",cache:!1,dataType:"json",data:t,success:function(e){var t=e.length,a=0,i="",o="#gvVentas";if(t>0){for(;a<t;){var n=e[a].SimboloMoneda+" "+Number(e[a].tm_base_imponible).toFixed(2),r=e[a].SimboloMoneda+" "+Number(e[a].tm_impuesto).toFixed(2),l=e[a].SimboloMoneda+" "+Number(e[a].tm_total).toFixed(2);i+="<div ",i+='data-id="'+e[a].tm_idventa+'" ',i+='class="result item pos-rel animate mdl-shadow--2dp margin10">',i+='<div class="col-md-4">',i+="<h4>ID Venta #"+e[a].tm_idventa+"</h4>",i+='<p class="lugar"><strong>Cod. Venta: </strong>'+e[a].CodigoVenta+"</p>",i+='<p class="lugar"><strong>Tipo de comprobante: </strong>'+e[a].TipoComprobante+"</p>",i+='<p class="lugar"><strong>Fecha: </strong>'+ConvertMySQLDate(e[a].tm_fecha_emision)+"</p>",i+="</div>",i+='<div class="col-md-4">',i+="<h4>Cliente:</h4>",i+='<span class="duracion">'+e[a].Cliente+"</span>",i+="</div>",i+='<div class="col-md-4">',i+='<h4 class="text-center">Monto de venta</h4>',i+='<h5 class="row"><strong class="col-md-4">Base imponible: </strong><span class="col-md-8 blue-text text-right">'+n+"</span></h5>",i+='<h5 class="row"><strong class="col-md-4">Impuestos deducidos: </strong><span class="col-md-8 blue-text text-right">'+r+"</span></h5>",i+='<h5 class="row"><strong class="col-md-4">Total de importe: </strong><span class="col-md-8 blue-text text-right">'+l+"</span></h5>",i+='<div class="clear"></div>',i+="</div>",i+="</div>",++a}gvVentas.currentPage(gvVentas.currentPage()+1),"1"==pagina?$(o).html(i):$(o).append(i)}else"1"==pagina&&$(o).html("<h2>No se encontraron resultados.</h2>");precargaExp("#pnlListado",!1)},error:function(e){console.log(e)}})}function AbrirAperturaCaja(){$("#ddlMonedaApertura")[0].selectedIndex=0,$("#txtImporteApertura").val("0.00"),openModalCallBack("#pnlAperturaCaja",function(){ListarPersonalPorTurno($("#ddlTurnoApertura").val())})}function AbrirCierreCaja(){openCustomModal("#pnlCierreCaja")}function AbrirListaVentas(){openModalCallBack("#pnlVentas",function(){})}function AbrirMovimientosCaja(){var e=moment(new Date).format("YYYY-MM-DD");$(".lblFechaHoy").text(e),openModalCallBack("#pnlCajaActual",function(){})}function InsertarCliente(){var e="",t=$('#gvServicio tbody tr[data-idservicio="'+idservicio_selected+'"]');if($("#rbObtenerCliente__Servicio")[0].checked)e=$("#txtSearchCliente__Servicio").val();else{idservicio_selected=0,idcliente_selected=0;var a=$("#txtApePaternoCliente__Servicio").val(),i=$("#txtApeMaternoCliente__Servicio").val(),o=$("#txtNombresCliente__Servicio").val();t.find(".serv_TipoDocCliente__Servicio").val($("#ddlTipoDocCliente__Servicio").val()),t.find(".serv_NroDocCliente__Servicio").val($("#txtNroDocCliente__Servicio").val()),t.find(".serv_ApePaternoCliente__Servicio").val(a),t.find(".serv_ApeMaternoCliente__Servicio").val(i),t.find(".serv_NombresCliente__Servicio").val(o),t.find(".serv_RazonSocialCliente__Servicio").val($("#txtRazonSocialCliente__Servicio").val()),t.find(".serv_DireccionCliente__Servicio").val($("#txtDireccionCliente__Servicio").val()),t.find(".serv_TelefonoCliente__Servicio").val($("#txtTelefonoCliente__Servicio").val()),t.find(".serv_EmailCliente__Servicio").val($("#txtEmailCliente__Servicio").val()),t.find(".serv_PaisCliente__Servicio").val($("#ddlPaisCliente__Servicio").val()),t.find(".serv_RegionCliente__Servicio").val($("#ddlRegionCliente__Servicio").val()),e=a+" "+i+" "+o}t.find(".serv_IdCliente__Servicio").val(idcliente_selected),t.find('.descripcion[data-title="Cliente"] strong').text(e),closeCustomModal("#pnlClientePorServicio")}$(function(){$("#hdFechaHoraApertura").val(moment().format("DD/MM/YYYY hh:mm:ss")),$("#lblFechaHoraApertura").val(moment().format("DD/MM/YYYY hh:mm:ss"));$("#btnInsertarCliente__Servicio").on("click",function(e){e.preventDefault(),InsertarCliente()}),$("#gvServicio").on("click",'button[data-action="select-cliente"]',function(e){e.preventDefault();var t=getParentsUntil(this,"#gvServicio tbody","tr");idservicio_selected=t[0].getAttribute("data-idservicio"),openModalCallBack("#pnlClientePorServicio",function(){MostrarTipoDocCliente("#ddlTipoDocCliente__Servicio","1");
})}),$("#btnAbrirAperturaCaja").on("click",function(e){e.preventDefault(),AbrirAperturaCaja()}),$("#btnMostrarVentas").on("click",function(e){e.preventDefault(),AbrirListaVentas()}),$("#btnMostrarCaja").on("click",function(e){e.preventDefault(),AbrirMovimientosCaja()}),$("#btnCerrarVentana").on("click",function(e){e.preventDefault(),window.top.closeWindowFromInside("?pag=procesos&subpag=caja&op=list")}),$("#mnuOpcionesMenu").on("click","a",function(e){e.preventDefault();var t=this.getAttribute("data-action");"ventas-view"==t?AbrirListaVentas():"caja-open"==t?AbrirAperturaCaja():"caja-close"==t?AbrirCierreCaja():"movcaja-view"==t&&AbrirMovimientosCaja()}),$("#btnAbrirFiltroVentas").on("click",function(e){e.preventDefault(),openCustomModal("#modalFiltroVentas")}),$("#btnVerVentas").on("click",function(e){e.preventDefault(),AbrirListaVentas()}),$("#txtSearchProd").on("keyup",function(e){e.preventDefault(),ListarInsumos("1")}),$("#txtSearchServ").on("keyup",function(e){e.preventDefault(),ListarServicios("1")}),$("#btnAgregar").on("click",function(e){e.preventDefault(),openModalCallBack("#pnlProductos",function(){ListarInsumos("1"),ListarServicios("1")})}),$("#gvArticuloMenu").on("click","a",function(e){e.preventDefault(),"delete"==this.getAttribute("data-action")&&eliminarArticulo(this)}),$("#txtImporteApertura").on("focus",function(e){e.preventDefault(),this.select()}),ComprobarApertura(),$("#ddlPaisCliente").on("change",function(e){e.preventDefault(),ListarUbicacion("#ddlRegionCliente",this.value,"0")}).trigger("change"),$("#ddlPaisCliente__Servicio").on("change",function(e){e.preventDefault(),ListarUbicacion("#ddlRegionCliente__Servicio",this.value,"0")}).trigger("change"),$("#chkClienteDefault").on("change",function(e){e.preventDefault();var t=this.checked;habilitarOptionCliente(!t),0==t?($("#rbObtenerCliente").prop("checked",!0),habilitarControl("#txtSearchCliente",!0),habilitarClienteNatural(!1),habilitarClienteJuridico(!1),habilitarControl("#ddlTipoDocCliente,#txtNroDocCliente,#txtDireccionCliente,#txtTelefonoCliente,#txtEmailCliente",!1),$("#rbObtenerCliente")[0].checked?(habilitarControl("#txtSearchCliente",!0),habilitarClienteNatural(!1),habilitarClienteJuridico(!1),habilitarControl("#ddlTipoDocCliente,#txtNroDocCliente,#txtDireccionCliente,#txtTelefonoCliente,#txtEmailCliente",!1)):(habilitarControl("#txtSearchCliente",!1),"NA"==$("#hdTipoCliente").val()?(habilitarClienteNatural(!0),habilitarClienteJuridico(!1)):(habilitarClienteNatural(!1),habilitarClienteJuridico(!0)),habilitarControl("#ddlTipoDocCliente,#txtNroDocCliente,#txtDireccionCliente,#txtTelefonoCliente,#txtEmailCliente",!0))):(habilitarControl("#txtSearchCliente",!1),habilitarClienteNatural(!1),habilitarClienteJuridico(!1),habilitarControl("#ddlTipoDocCliente,#txtNroDocCliente,#txtDireccionCliente,#txtTelefonoCliente,#txtEmailCliente",!1))}),$('input:radio[name="rbRegCliente"]').on("change",function(e){habilitarModuloCliente("cliente",this.value)}),$('input:radio[name="rbRegCliente__Servicio"]').on("change",function(e){habilitarModuloCliente("servicio",this.value)}),$("#txtSearchCliente").easyAutocomplete({url:function(e){var t="services/clientes/clientes-autocomplete.php";return t+="?idempresa="+$("#hdIdEmpresa").val(),t+="&idcentro="+$("#hdIdCentro").val(),t+="&tipobusqueda=3",t+="&criterio="+e},getValue:function(e){return e.nombrecompleto},list:{onSelectItemEvent:function(){var e=$("#txtSearchCliente").getSelectedItemData().tm_idcliente;$("#hdIdCliente").val(e).trigger("change")}},template:{type:"custom",method:function(e,t){return t.nombrecompleto}},theme:"square"}),$("#txtSearchCliente__Servicio").easyAutocomplete({url:function(e){var t="services/clientes/clientes-autocomplete.php";return t+="?idempresa="+$("#hdIdEmpresa").val(),t+="&idcentro="+$("#hdIdCentro").val(),t+="&tipobusqueda=3",t+="&criterio="+e},getValue:function(e){return e.nombrecompleto},list:{onSelectItemEvent:function(){idcliente_selected=$("#txtSearchCliente__Servicio").getSelectedItemData().tm_idcliente}},template:{type:"custom",method:function(e,t){return t.nombrecompleto}},theme:"square"}),$("#btnChooseTipoItem").on("click",function(e){e.preventDefault(),e.stopPropagation(),$("#mnuTipoItem").addClass("is-visible")}),$("#mnuTipoItem").on("click","a",function(e){var t=this.getAttribute("data-tipoitem");"00"==t?($("#pnlSearchArticulo, #gvInsumo").removeClass("hide"),$("#pnlSearchServicio, #gvServicio").addClass("hide")):($("#pnlSearchArticulo, #gvInsumo").addClass("hide"),$("#pnlSearchServicio, #gvServicio").removeClass("hide")),$("#btnChooseTipoItem").find(".text").text(this.innerHTML).end().attr("data-tipoitem",t),$("#mnuTipoItem").removeClass("is-visible")}),$("#ddlTurnoApertura").on("change",function(e){e.preventDefault(),ListarPersonalPorTurno($(this).val())}),$("#gvServicio tbody").on("scroll",function(e){gvServicio.listenerScroll(this,e)}),$("#gvInsumo tbody").on("scroll",function(e){gvInsumo.listenerScroll(this,e)}),$("#gvServicio tbody").on("click","input:checkbox",function(e){this.checked?habilitarControl("#btnAddItemsVenta",!0):0==$("#gvServicio input:checked").length&&habilitarControl("#btnAddItemsVenta",!1)}),$("#gvInsumo tbody").on("click","input:checkbox",function(e){var t=getParentsUntil(this,"#gvInsumo","tr");console.log(t[0]);var a=t[0].getElementsByClassName("cantidad")[0],i=t[0].getElementsByClassName("precio")[0],o=t[0].getElementsByClassName("subtotal")[0].getElementsByTagName("input")[0],n=t[0].getElementsByTagName("h4")[0];this.checked?(a.removeAttribute("disabled"),i.removeAttribute("disabled"),n.classList.remove("grey-text"),a.focus(),habilitarControl("#btnAddItemsVenta",!0)):(a.setAttribute("disabled",""),a.value="",o.value="",i.setAttribute("disabled",""),n.classList.add("grey-text"),n.innerHTML="0.00",0==$("#gvInsumo input:checked").length&&habilitarControl("#btnAddItemsVenta",!1))}),$("#gvInsumo tbody").on("keyup",'input[type="number"]',function(e){var t=e.target,a=0,i=0,o=getParentsUntil(t,"#gvInsumo","tr");o=o[0],t.classList.contains("cantidad")?(i=t.value,a=o.getElementsByClassName("precio")[0].value):(i=o.getElementsByClassName("cantidad")[0].value,a=t.value);var n=i*a,r=o.getElementsByClassName("subtotal")[0];r.getElementsByTagName("input")[0].value=n.toFixed(2),r.getElementsByTagName("h4")[0].innerHTML=n.toFixed(2)}),$("#btnAddItemsVenta").on("click",function(e){e.preventDefault(),"00"==$("#btnChooseTipoItem").attr("data-tipoitem")?AgregarItemsVenta():AgregarServicio()}),$("#btnInfoOrden").on("click",function(e){e.preventDefault(),$(this).hasClass("active")?($(this).removeClass("active").attr("data-tooltip","M&aacute;s informaci&oacute;n").html('<i class="left material-icons">&#xE88E;</i> M&aacute;s informaci&oacute;n'),$("#pnlInfoOrden").fadeOut(300,function(){$("#pnlDetalleOrden").fadeIn(300,function(){})})):($(this).addClass("active").attr("data-tooltip","Volver al detalle de orden").html('<i class="left material-icons">&#xE5C4;</i> Volver al detalle de orden'),$("#pnlDetalleOrde.end()n").fadeOut(300,function(){$("#pnlInfoOrden").fadeIn(300,function(){})}))}),$("#btnGestionarCobranza").on("click",function(e){e.preventDefault(),GestionarCobranza()}),$("#btnCobrar").on("click",function(e){e.preventDefault(),GuardarCobranza()}),$("#btnImprimir").on("click",function(e){e.preventDefault(),window.print()}),$("#datetimepickerFHA").datetimepicker({inline:!0,locale:"es",format:"DD/MM/YYYY hh:mm A"}),$("#btnCloseFechaHoraApertura").on("click",function(e){e.preventDefault(),toggleOptions_v2("#pnlFechaHora","left")}),$("#btnMostrarFechaHoraApertura").on("click",function(e){e.preventDefault(),toggleOptions_v2("#pnlFechaHora","left")}),$("#btnEstablecerFechaHoraApertura").on("click",function(e){e.preventDefault();var t=$("#datetimepickerFHA").data("date");$("#lblFechaHoraApertura").text(t),$("#hdFechaHoraApertura").val(t),toggleOptions_v2("#pnlFechaHora","left")}),$("#btnRegistrarApertura").on("click",function(e){e.preventDefault(),RegistrarAperturaCaja()}),$("#btnRegistrarMovCaja").on("click",function(e){e.preventDefault(),RegistrarMovCaja()}),$("#btnCerrarCaja").on("click",function(e){e.preventDefault(),MessageBox({content:"¿Desea cerrar caja?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Cerrar caja",onClickButton:function(e){CerrarCaja()}}],cancelButton:!0})}),$("#pnlCajaActual .btn-group").on("click","button",function(e){e.preventDefault();this.getAttribute("data-tipomov");$(this).siblings(".btn-primary").removeClass("btn-primary"),$(this).addClass("btn-primary"),AperturaByDefault()}),$("#btnAddMovimiento").on("click",function(e){e.preventDefault(),openCustomModal("#pnlRegMovimientoCaja")}),$("#txtSearchPersonal").easyAutocomplete({url:function(e){return"services/organigrama/organigrama-search.php?criterio="+e+"&tipobusqueda=1&idempresa="+$("#hdIdEmpresa").val()+"&idcentro="+$("#hdIdCentro").val()},getValue:function(e){return e.tm_nrodni.toLowerCase()+" - "+e.tm_apellidopaterno+" "+e.tm_apellidomaterno+" "+e.tm_nombres},list:{onSelectItemEvent:function(){var e=$("#txtSearchPersonal").getSelectedItemData().tm_idpersonal;$("#hdIdPersona").val(e).trigger("change")}},template:{type:"custom",method:function(e,t){return t.tm_nrodni.toLowerCase()+" - "+t.tm_apellidopaterno+" "+t.tm_apellidomaterno+" "+t.tm_nombres}},theme:"square"})});var filaArticulo=0,idservicio_selected=0,idcliente_selected=0,messagesValid={txtNroDocCliente:{required:"El número de documento es obligatorio"}},gvInsumo=new DataList("#gvInsumo",{onSearch:function(){ListarInsumos(gvInsumo.currentPage())}}),gvServicio=new DataList("#gvServicio",{onSearch:function(){ListarServicios(gvServicio.currentPage())}}),gvVentas=new DataList("gvVentas",{actionbar:"generic-actionbar",onSearch:function(){ListSalesByDate(gvVentas.currentPage())}});